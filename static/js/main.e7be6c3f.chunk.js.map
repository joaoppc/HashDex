{"version":3,"sources":["App.js","index.js"],"names":["App","props","sym","state","selectValue","localStorage","getItem","handleChange","bind","this","toLowerCase","socketTrade","WebSocket","myRequest","Request","socketOrder","fetch","then","response","json","x","length","document","getElementById","innerHTML","areaSeries","createChart","width","height","layout","textColor","backgroundColor","rightPriceScale","scaleMargins","top","bottom","crosshair","vertLine","color","style","horzLine","visible","labelVisible","grid","vertLines","horzLines","addAreaSeries","topColor","bottomColor","lineColor","lineWidth","crossHairMarkerVisible","onmessage","event","object","JSON","parse","data","console","log","t","update","time","value","p","am4core","am4themes_animated","chart","am4charts","dataSource","url","reloadFrequency","adapter","add","processData","list","type","desc","i","Number","volume","sort","a","b","totalvolume","dp","res","unshift","push","bids","asks","numberFormatter","numberFormat","xAxis","xAxes","dataFields","category","renderer","minGridDistance","title","text","toUpperCase","yAxes","series","categoryX","valueY","strokeWidth","stroke","fill","fillOpacity","tooltipText","series2","series3","series4","cursor","buy","sell","order","onopen","onerror","onclose","code","e","setState","target","setItem","window","location","reload","className","id","onChange","Component","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.e7be6c3f.chunk.js","sourcesContent":["import './App.css'; \nimport React, {Component} from 'react';\nimport { createChart } from 'lightweight-charts';\nimport * as am4core from \"@amcharts/amcharts4/core\";\nimport * as am4charts from \"@amcharts/amcharts4/charts\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\n\n\n\n\n\n\nclass App extends Component{\n   constructor(props){\n    super(props);\n    this.sym='btcusdt';\n    this.state = {\n      selectValue: localStorage.getItem('selected'),\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    \n\n  }  \n  \n  componentDidMount(){\n\n    \n    if (this.state.selectValue !== null){\n      this.sym = this.state.selectValue.toLowerCase()+'usdt'\n    }\n    \n    const socketTrade = new WebSocket(\"wss://stream.binance.com:9443/ws/\"+this.sym+\"@trade\");\n    const myRequest = new Request('https://api.hashdex.io/prod/marketdata/v1/index/HDAI/last');\n    const socketOrder = new WebSocket(\"wss://stream.binance.com:9443/ws/\"+this.sym+\"@depth10\");\n    \n    \n\n    \n    \n    \n\n    /////Asset constituent/////\n    fetch(myRequest).then(response=>response.json()).then(json=>{\n      for(var x=0;x<json['constituents'].length;x++){\n      document.getElementById('lista').innerHTML += json['constituents'][x]['assetId']+':    '+json['constituents'][x]['currentPrice']+\"<br>\";\n      document.getElementById('asset').innerHTML +=\"<option value=\"+json['constituents'][x]['assetId']+'>'+json['constituents'][x]['assetId']+'</option>'\n\n      }  \n      \n      \n    });\n    \n    var chartO = createChart(document.getElementById('chart'), {\n      width: 900,\n      height: 600,\n      layout: {\n        textColor: '#d1d4dc',\n        backgroundColor: '#000000',\n      },\n      rightPriceScale: {\n        scaleMargins: {\n          top: 0.3,\n          bottom: 0.25,\n        },\n      },\n      crosshair: {\n        vertLine: {\n          width: 5,\n          color: 'rgba(224, 227, 235, 0.1)',\n          style: 0,\n        },\n        horzLine: {\n          visible: false,\n          labelVisible: false,\n        },\n      },\n      grid: {\n        vertLines: {\n          color: 'rgba(42, 46, 57, 0)',\n        },\n        horzLines: {\n          color: 'rgba(42, 46, 57, 0)',\n        },\n      },\n    });\n    \n    var areaSeries = chartO.addAreaSeries({\n      topColor: 'rgba(38, 198, 218, 0.56)',\n      bottomColor: 'rgba(38, 198, 218, 0.04)',\n      lineColor: 'rgba(38, 198, 218, 1)',\n      lineWidth: 2,\n      crossHairMarkerVisible: false,\n    });\n    \n\n    \n\n    \n    socketTrade.onmessage = function (event) {\n      var object = JSON.parse(event.data);\n      console.log(object.t)\n      ///////////price chart///////////////////\n      areaSeries.update({\n        time: object.t/1000,\n        value: object.p\n      }); \n      ////////////////////////////////////////\n      \n    }\n\n\n    // Themes begin\n    am4core.useTheme(am4themes_animated);\n    // Themes end\n\n    // Create chart instance\n    var chart = am4core.create(\"orderChart\", am4charts.XYChart);\n    \n\n    // Add data\n    \n    chart.dataSource.url = \"https://api.binance.com/api/v3/depth?symbol=\"+this.state.selectValue+\"USDT&limit=100\";\n    chart.dataSource.reloadFrequency = 30000;\n    chart.dataSource.adapter.add(\"parsedData\", function(data) {\n      \n      // Function to process (sort and calculate cummulative volume)\n      function processData(list, type, desc) {\n\n        // Convert to data points\n        for(var i = 0; i < list.length; i++) {\n          list[i] = {\n            value: Number(list[i][0]),\n            volume: Number(list[i][1]),\n          }\n        }\n\n        // Sort list just in case\n        list.sort(function(a, b) {\n          if (a.value > b.value) {\n            return 1;\n          }\n          else if (a.value < b.value) {\n            return -1;\n          }\n          else {\n            return 0;\n          }\n        });\n\n        // Calculate cummulative volume\n        if (desc) {\n          for(var i = list.length - 1; i >= 0; i--) {\n            if (i < (list.length - 1)) {\n              list[i].totalvolume = list[i+1].totalvolume + list[i].volume;\n            }\n            else {\n              list[i].totalvolume = list[i].volume;\n            }\n            var dp = {};\n            dp[\"value\"] = list[i].value;\n            dp[type + \"volume\"] = list[i].volume;\n            dp[type + \"totalvolume\"] = list[i].totalvolume;\n            res.unshift(dp);\n          }\n        }\n        else {\n          for(var i = 0; i < list.length; i++) {\n            if (i > 0) {\n              list[i].totalvolume = list[i-1].totalvolume + list[i].volume;\n            }\n            else {\n              list[i].totalvolume = list[i].volume;\n            }\n            var dp = {};\n            dp[\"value\"] = list[i].value;\n            dp[type + \"volume\"] = list[i].volume;\n            dp[type + \"totalvolume\"] = list[i].totalvolume;\n            res.push(dp);\n          }\n        }\n\n      }\n\n      // Init\n      var res = [];\n      processData(data.bids, \"bids\", true);\n      processData(data.asks, \"asks\", false);\n\n      return res;\n    });\n\n    // Set up precision for numbers\n    chart.numberFormatter.numberFormat = \"#,###.####\";\n\n    // Create axes\n    var xAxis = chart.xAxes.push(new am4charts.CategoryAxis());\n    xAxis.dataFields.category = \"value\";\n    //xAxis.renderer.grid.template.location = 0;\n    xAxis.renderer.minGridDistance = 70;\n    if (this.state.selectValue !== null){\n      xAxis.title.text = this.state.selectValue.toUpperCase()+\"/USDT\";\n    }\n    else{\n      xAxis.title.text = \"BTC/USDT\"\n    }\n    \n\n    var yAxis = chart.yAxes.push(new am4charts.ValueAxis());\n    yAxis.title.text = \"Volume\";\n\n    // Create series\n    var series = chart.series.push(new am4charts.StepLineSeries());\n    series.dataFields.categoryX = \"value\";\n    series.dataFields.valueY = \"bidstotalvolume\";\n    series.strokeWidth = 2;\n    series.stroke = am4core.color(\"#0f0\");\n    series.fill = series.stroke;\n    series.fillOpacity = 0.1;\n    series.tooltipText = \"Bid: [bold]{categoryX}[/]\\nTotal volume: [bold]{valueY}[/]\\nVolume: [bold]{bidsvolume}[/]\"\n\n    var series2 = chart.series.push(new am4charts.StepLineSeries());\n    series2.dataFields.categoryX = \"value\";\n    series2.dataFields.valueY = \"askstotalvolume\";\n    series2.strokeWidth = 2;\n    series2.stroke = am4core.color(\"#f00\");\n    series2.fill = series2.stroke;\n    series2.fillOpacity = 0.1;\n    series2.tooltipText = \"Ask: [bold]{categoryX}[/]\\nTotal volume: [bold]{valueY}[/]\\nVolume: [bold]{asksvolume}[/]\"\n\n    var series3 = chart.series.push(new am4charts.ColumnSeries());\n    series3.dataFields.categoryX = \"value\";\n    series3.dataFields.valueY = \"bidsvolume\";\n    series3.strokeWidth = 0;\n    series3.fill = am4core.color(\"#000\");\n    series3.fillOpacity = 0.2;\n\n    var series4 = chart.series.push(new am4charts.ColumnSeries());\n    series4.dataFields.categoryX = \"value\";\n    series4.dataFields.valueY = \"asksvolume\";\n    series4.strokeWidth = 0;\n    series4.fill = am4core.color(\"#000\");\n    series4.fillOpacity = 0.2;\n\n    // Add cursor\n    chart.cursor = new am4charts.XYCursor(); \n\n\n\n////////////////////////////////////////////////////////////////////////////////////////\n\n    var buy = document.getElementById('buy');\n    var sell = document.getElementById('sell');\n    socketOrder.onmessage = function (event) {\n      buy.innerHTML = 'Buy<br>';\n      sell.innerHTML = 'Sell<br>';\n      var order = JSON.parse(event.data);\n      console.log(order)\n\n      for (let i = 0; i < 10; i++) {\n        buy.innerHTML +=\"Price: \"+ order.bids[i][0]+\"          Volume: \"+order.bids[i][1]+\"<br>\";\n        sell.innerHTML +=\"Price: \"+ order.asks[i][0]+\"          Volume: \"+order.asks[i][1]+\"<br>\";\n      }\n     \n    }\n    socketOrder.onopen = function(event){\n      console.log(event);\n    }\n    socketOrder.onerror = function (event) {\n      console.log(event.data);\n   };\n   socketOrder.onclose = function(event) {\n    if (event.code === 1000) {\n      console.log('WebSocket closed normally');\n    } else {\n        console.log('WebSocket closed unexpectedly: ' + event.code);\n    }\n  }\n   \n\n  }\n\n\n  \n  handleChange(e) {\n    console.log(\"Asset selected\");\n    this.setState({ selectValue: e.target.value });\n    localStorage.setItem('selected', e.target.value)\n    window.location.reload();\n  }\n  render() {\n    return(\n      <div className=\"App\">\n        <h2>\n          HashDex Dashboard\n        </h2>\n        <div>\n        \n          <select id = 'asset' onChange={this.handleChange}>\n            <option>Select</option>  \n          </select>\n          <h3>{localStorage.getItem('selected')}</h3>\n        </div>\n        <div className = 'App-firstRow'>\n          <div id='lista' className='App-lista'>\n          </div>\n          <div className='App-chart' id='chart'>\n          </div>\n        </div>\n        <div className = 'App-secondRow'>\n          <div id ='order' className ='App-order'>\n            Asset:{localStorage.getItem('selected')}\n            <div id = 'buy' className = 'App-buy' ></div>\n            <div id = 'sell' className = 'App-sell'></div>\n          </div>\n      \n          <div id = 'orderChart' className='App-orderchart'> \n          </div>\n        </div>\n      \n      </div>\n\n    );\n  }\n}\n\n\n\n\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}